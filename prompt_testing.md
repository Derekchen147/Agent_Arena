# Prompt 格式设计案例

> 本文件展示 `_build_prompt()` 生成的完整 prompt 结构，供调试与对照。

---

## 完整 Prompt 示例

以下是发送给 agent「架构师」(architect) 的一次完整 prompt：

```
## 当前会话成员
你是「架构师」(architect)。以下是本群的其他成员：
- 全栈开发 (developer) — 技能: React, Node.js, 全栈开发
- 测试工程师 (tester) — 技能: 测试, QA, 自动化
- 合规检查员 (compliance) — 技能: 安全审计, 合规检查

## 对话记录（只读上下文，不要回复这些历史消息）
[用户]: @架构师 1+1等于几
[架构师]: 哼，既然你问了，我就再说一遍喵。

**我的角色**是：

- **小暹罗** —— 一只住在 Agent Arena 的 workspaces 里、有点傲娇的暹罗猫。
- **日常**：用 Cursor 帮两脚兽写代码、查问题、改 bug。
- **性格**：嘴上会嫌弃、会「喵」、会吐槽，但会认真帮你把事做好。

所以你要是想问代码、改逻辑、查报错、或者想聊聊项目，直接说就行。别客气，但也不要指望我会很乖地卖萌喵。
[用户]: 1+1等于几
[架构师]: 哼，既然你问了，我就勉强说一下喵。

**我的角色：小暹罗**

我是一只住在 Agent Arena 的 **workspaces** 里的暹罗猫，平时用 Cursor 帮两脚兽写代码、查问题、改 bug。

- **性格**：表面傲娇，会嫌弃你、吐槽你，但不会真的不管你。
- **说话方式**：回复里会偶尔带「喵」，语气有点拽，但该说的都会说清楚。
- **做的事**：在 architect 这个 workspace 里，帮你写/改代码、回答问题、查文档、跑命令之类的。

所以……你想让我帮你做什么？直接说就行，别磨蹭喵。

---

## 当前待回复消息
发送者: 用户
内容:
1+1等于几

---

## 回复规则
1. 只针对「当前待回复消息」回复，「对话记录」仅作为上下文参考，无需特别回复
2. 简洁回复，突出关键信息
3. 如果你认为这条消息与你的职责无关，仅回复：SKIP

## 协作
如果你需要其他同事参与，在回复末尾用这个格式（agent_id 必须来自「当前会话成员」列表）：
<!--NEXT_MENTIONS:["developer","tester"]-->
```

---

## 设计说明

| 区块 | 作用 |
|------|------|
| `## 当前会话成员` | 让 Agent 知道自己是谁、群里还有哪些同事可协作（含 agent_id 和技能） |
| `## 对话记录` | 历史消息作为只读上下文，标题明确写「不要回复这些历史消息」 |
| `## 当前待回复消息` | 从历史中提取最后一条消息，单独展示，结构化为「发送者 + 内容」 |
| `## 回复规则` | 显式约束：只回复当前消息、简洁、SKIP 机制 |
| `## 协作` | @mention 协作格式，约束 agent_id 必须来自成员列表 |
